{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Spring School on Computational Chemistry Basic QC hands-on","text":"<p>This repository contains hands-on tutorials designed for the Spring School on Computational Chemistry. The exercises use the TmoleX graphical user interface together with the TURBOMOLE engine running on Puhti.  Note: TURBOMOLE requires a license, which is available for academic users on CSC supercomputers.</p>"},{"location":"#preparations","title":"Preparations","text":"<ul> <li>Set up TmoleX either via a browser or by installing it on your own laptop.</li> </ul>"},{"location":"#tutorial-1","title":"Tutorial 1","text":"<ul> <li>Use TmoleX to prepare a geometry optimization of a small molecule at the DFT level.</li> <li>Submit the job via TmoleX to Puhti, where the actual calculation is performed.</li> <li>Use TmoleX to monitor the progress of the job.</li> <li>Use TmoleX to retrieve and analyze the results.</li> </ul>"},{"location":"#tutorial-2","title":"Tutorial 2","text":"<ul> <li>Perform multiple geometry optimizations of various isomers.</li> <li>Switch to a higher-quality basis set for a single-point energy calculation.</li> <li>Benchmark resource usage by analyzing job durations relative to the resources used.</li> <li>Construct your own job template and apply it to a set of molecules.</li> </ul>"},{"location":"preparations/","title":"Using TmoleX to Run TURBOMOLE Jobs on Puhti","text":"<p>This guide helps you set up the TmoleX graphical interface to run TURBOMOLE calculations on CSC's Puhti supercomputer.</p>"},{"location":"preparations/#setup-tmolex","title":"Setup TmoleX","text":"<p>TmoleX is a user-friendly graphical interface for preparing, submitting, and analyzing TURBOMOLE jobs. It includes a structure builder and tools to manage calculations, both locally and on remote HPC systems such as CSC's Puhti. You can run TmoleX in two ways:</p> <ul> <li>Via browser through CSC\u2019s remote desktop interface.</li> <li>Locally on your desktop and submit jobs to Puhti over the network.</li> </ul> <p>The free TmoleX Client version can be used from your local Windows, Linux, or macOS desktop to run TURBOMOLE at CSC. It can be downloaded (registration required) from the Dassault Syst\u00e8mes website. This demo version includes a restricted version of TURBOMOLE.</p> Using TmoleX via the browser Using TmoleX from your local pc"},{"location":"preparations/#usage","title":"Usage","text":""},{"location":"preparations/#use-tmolex-via-browser","title":"Use TmoleX via browser","text":"<ol> <li> <p>Open puhti.csc.fi in your browser and log in with your CSC/Haka credentials.</p> </li> <li> <p>Launch a Desktop session.    </p> </li> <li> <p>In the Desktop launcher:</p> <ul> <li>Activate reservation: <code>sscc_thu_small</code></li> <li>Project: <code>project_2013760 (SSCC2025)</code></li> <li>Partition: <code>small</code></li> <li>Use the default resources and submit the request</li> </ul> <p></p> </li> <li> <p>Once resources are allocated, launch the Desktop.</p> </li> <li>Open a terminal and load TURBOMOLE: <code>module load turbomole/7.8</code> </li> <li>Start TmoleX with the command <code>TmoleX24</code>.</li> </ol>"},{"location":"preparations/#prepare-tmolex-for-batch-jobs","title":"Prepare TmoleX for batch jobs","text":"<ul> <li>Select <code>New Project</code> and define a project path (e.g. <code>/scratch/project_2013760/&lt;your-username&gt;/qc_tutorial1</code>).</li> <li>Go to <code>Extras-&gt;Preferences-&gt;General</code> and set  <code>User directory</code> to <code>/scratch/project_2013760/&lt;your-username&gt;</code></li> <li>Small jobs can be run interactively, but for larger jobs you should use the queue system. </li> </ul> <p>Now configure the remote machine:</p> <ol> <li>In TmoleX open <code>Extras-&gt;Remote Systems-&gt;Add new Machine</code></li> <li> <p>Set Machine name to <code>puhti-login12.bullx</code> </p> <p></p> </li> <li> <p><code>User</code> is your CSC username, <code>Group name</code> and <code>Identification</code> are just tags you can set to distinguish different configurations  </p> </li> <li>Tick <code>Expert settings</code> and <code>no password</code>.  </li> <li>Work directory is a place where temporary files are stored:    <code>/scratch/project_2013760/&lt;your-username&gt;/TM_TMPDIR</code> </li> <li>TURBOMOLE directory should point to were it is installed:    <code>/appl/soft/chem/turbomole/7.8/TURBOMOLE</code></li> <li>Tick <code>Use queuing system</code></li> <li>Submit with <code>sbatch</code> and Check status with  <code>squeue -u $USER</code></li> <li> <p>Untick <code>add PARA_ARCH</code> and <code>add PARNODES</code>.</p> </li> <li> <p>In the field \"Script before job execution\" add: <pre><code>#SBATCH --reservation=sscc_thu_small                  # resource reservation for school\n#SBATCH --partition=small                             # queue\n#SBATCH --nodes=1                                     # for SMP only 1 is possible\n#SBATCH --cpus-per-task=4                             # SMP threads\n#SBATCH --account=project_2013760                     # insert here the project to be billed\n#SBATCH --time=00:30:00                               # time as `hh:mm:ss`\nsource /appl/profile/zz-csc-env.sh\nulimit -s unlimited\nexport PARA_ARCH=SMP                                  # use SMP threads\nmodule load turbomole/7.8\nexport PARNODES=$SLURM_CPUS_PER_TASK                  # for SMP\nexport PATH=$TURBODIR/bin/`$TURBODIR/scripts/sysname`:$PATH\n</code></pre></p> </li> <li> <p>Remember to save the settings using <code>Save Machine</code>.</p> </li> </ol>"},{"location":"preparations/#install-your-own-tmolex","title":"Install your own TmoleX","text":"<p>Install the TmoleX client on your local workstation. For details, see the registration and download page at Dassault Syst\u00e8mes website. With your version of TmoleX you can build your actual job locally and then submit the job to Puhti. With the client you can monitor how the job proceeds. When the job has completed you can retrieve the output and use your local client to analyze the results.</p>"},{"location":"tutorial1/","title":"Tutorial 1: Basic DFT calculations using TmoleX and TURBOMOLE","text":"<ul> <li>Spring School on Computational Chemistry 23-25 April 2025</li> <li>Nino Runeberg, CSC - IT center for Science Ltd, based on the earlier work of Atte Sillanp\u00e4\u00e4</li> </ul>"},{"location":"tutorial1/#overview","title":"Overview","text":"<ol> <li>TmoleX is a graphical user interface to set up, launch and run jobs with TURBOMOLE</li> <li>This tutorial is made for use with TmoleX 24 and TUBOMOLE 7.8</li> <li>We'll use TmoleX to set up a formaldehyde geometry optimization</li> <li>Configure and submit the job to be run on puhti.csc.fi supercomputer</li> <li>Perform a subsequent frequency calculation on the optimized structure</li> <li>Visualize results</li> </ol>"},{"location":"tutorial1/#tmolex-setup-at-csc","title":"TmoleX setup at CSC","text":"<ul> <li>TmoleX can be used either via a browser or by running it on your local    computer (see Preparations )   </li> <li>The model system and input parameters for the TUBOMOLE job are specified  using TmoleX</li> <li>A connection to puhti.csc.fi is set up in TmoleX using ssh (Only passwordless ssh allowed)</li> <li>Installation directory and supercomputer specific options are set in TmoleX so that the GUI can   launch the job for the queueing system (SLURM) on the Puhti</li> <li>TmoleX can follow the progress and once the job has completed, the results are retreived</li> <li>The CSC TmoleX page has more information </li> <li>The overall CSC supercomputer environment can be found in the Docs CSC user guide   or in the CSC Computing environment self learning course materials.</li> <li>TURBOMOLE can also be used directly from the Puhti command line.</li> </ul> Using TmoleX via the browser Using TmoleX from local pc <p>The TURBOMOLE philosophy or program structure is based on running different \"modules\" one after another. The following diagram taken from a TURBOMOLE tutorial highlights the most typical ones and their relation.</p> <p></p>"},{"location":"tutorial1/#task-1-optimize-the-ground-state-for-formaldehyde","title":"Task 1: Optimize the ground state for formaldehyde","text":"<p>We need an initial guess for the geometry specifying the 3N-6 internal nuclear coordinates. This initial structure place the system on the energy surface that is uniquely defined by the computational model we are going to use (B-O approx.).  The performance of the model often vary at different parts of the surface.</p> <p></p>"},{"location":"tutorial1/#launch-tmolex-via-your-browser","title":"Launch TmoleX via your browser","text":"<p>Go to puhti.csc.fi using a web browser and login using your CSC/Haka user account.</p> <ol> <li>From there launch a Desktop. </li> <li>Open a <code>Terminal</code> and load the TURBOMOLE module <code>module load turbomole/7.8</code>.</li> <li>Start TmoleX with the command <code>TmoleX24</code>. </li> <li>Select <code>New Project</code> and define a suitable project in the <code>File Name</code> slot    (e.g. <code>/scratch/project_2013760/&lt;your-username&gt;/qc_tutorial1</code>). </li> <li>Define your system and type of calculation. </li> <li>Small jobs can be run interactively: Start Job -&gt; Run (local)</li> <li>Larger jobs should be run as batch jobs: Start Job -&gt; Run (network). Example    settings are given below. Note that passwordless connection doesn't work via    the browser. Remember to save the settings using <code>Save Machine</code>.</li> </ol> <p></p>"},{"location":"tutorial1/#define-your-first-turbomole-job","title":"Define your first turbomole job","text":"<p>A complete Turbomole job comprises the sequence:</p> <ul> <li>Geometry - Atomic Attributes - Molecular Attributes - Method - Start Job - Results</li> </ul>"},{"location":"tutorial1/#geometry-build-formaldehyde","title":"Geometry -- Build formaldehyde","text":"<p>Open the 3D builder, right-click on canvas and load formaldehyde from the library </p> <p>Close the builder and continue to Atomic Attributes</p>"},{"location":"tutorial1/#atomic-attributes-select-basis-set","title":"Atomic Attributes: Select basis set","text":"<p>Select the default def-SV(P) basis set</p> <p> </p> <p>Continue to Molecular Attributes</p>"},{"location":"tutorial1/#molecular-attributes-generate-initial-guess-mos","title":"Molecular Attributes -- Generate initial guess MOs","text":"<p>Generate initial MOs by doing an extended H\u00fcckel calculation</p> <p></p> <p>Continue to Method</p>"},{"location":"tutorial1/#method-define-your-method","title":"Method -- Define your method","text":"<p>Select the default method (ri-dft BP86/m3)</p> <p></p> <p>Continue to Start Job</p>"},{"location":"tutorial1/#start-job-define-your-job-type","title":"Start Job -- Define your job type","text":"<p>We want to do a geometry optimization of the ground state.</p> <p></p> <p>Smaller jobs can be run directly, <code>Run (local)</code>, but for larger jobs we should reserve resourses via the queuing system.  Continue to <code>Run (network)</code></p>"},{"location":"tutorial1/#runnetwork-setup-remote-job","title":"Run(network) -- Setup remote job","text":"<p>Click Save as the first dialog prompts for the folder to use for the job files. </p> <p>In the new dialog, we define the remote (Puhti) configuration:</p> <ul> <li>Which user account and project to use</li> <li>Where TURBOMOLE is installed etc.</li> <li>What type of resources we want to use for this job</li> </ul> <p>TURBOMOLE can be run in parallel either via a shared memory approach (SMP, only within a single node) or  by using MPI parallelization (possible to run a job over several nodes). In this tutorial we will use the SMP version.</p> <p>Smaller jobs can be run directly (<code>Run (local)</code>), but for larger jobs we should reserve resourses via the queuing system.  </p> <p>Tip</p> <p>You can use the Desktop Clipboard to easily copy content between the notes and the Desktop environment.</p> <ol> <li>The Machine is called <code>puhti-login12.bullx</code></li> <li><code>User</code> is your CSC username, <code>Group name</code> and <code>Identification</code> are just tags you can set to distinguish different configurations</li> <li>Tick <code>Expert settings</code>and <code>no password</code>.<ul> <li>Check that the access works by clicking <code>Check Password Settings</code> </li> </ul> </li> <li>Work directory is a place where temporary files are stored:    <code>/scratch/project_2013760/&lt;your-username&gt;/TM_TMPDIR</code> </li> <li>TURBOMOLE directory should point to were it's installed:    <code>/appl/soft/chem/turbomole/7.8/TURBOMOLE</code></li> <li>Tick <code>Use queuing system</code></li> <li>Submit with <code>sbatch</code> and Check status with  <code>squeue -u $USER</code></li> <li>Untick <code>add PARA_ARCH</code> and <code>add PARNODES</code> </li> <li>In the field \"Script before job execution\" add:</li> </ol> <p><pre><code>#SBATCH --reservation=sscc_thu_small                  # resource reservation for school\n#SBATCH --partition=small                             # queue\n#SBATCH --nodes=1                                     # for SMP only 1 is possible\n#SBATCH --cpus-per-task=4                             # SMP threads\n#SBATCH --account=project_2013760                     # insert here the project to be billed\n#SBATCH --time=00:30:00                               # time as `hh:mm:ss`\nsource /appl/profile/zz-csc-env.sh\nulimit -s unlimited\nexport PARA_ARCH=SMP                                  # use SMP threads\nmodule load turbomole/7.8\nexport PARNODES=$SLURM_CPUS_PER_TASK                  # for SMP\nexport PATH=$TURBODIR/bin/`$TURBODIR/scripts/sysname`:$PATH\n</code></pre> *  Remember to save save the settings using <code>Save Machine</code>.    Click Start Job* at the bottom right</p> <ul> <li>For this tutorial, the default 1 minute interval to ping Puhti for the job status is ok, but for actual production jobs, that could be increased to e.g. 1 hour. The status can always be refreshed manually. This job should finish in seconds.</li> </ul> <p></p>"},{"location":"tutorial1/#results-structure","title":"Results -- structure","text":"<p>The geometry optimization needed 5 cycles to reach the stationary point on the energy surface.</p> <p></p>"},{"location":"tutorial1/#results-gradients","title":"Results -- Gradients","text":"<p>The length of the arrows show how steep the energy surface is in that direction</p> <p></p> <p>At the end of the geometry optimization we have reached a stationary point (gradient smaller than a given threshold) that could correspond to:</p> <p></p> <ul> <li>a minimum A</li> <li>inflection point B</li> <li>a maximum C</li> </ul> <p>The nature of the stationary point can be deduced from the curvature (Hessian). A positive curvature corresponds to a minimum, a negative to a maximum.</p>"},{"location":"tutorial1/#vibrational-spectrum","title":"Vibrational spectrum","text":"<p>In order to verify that the stationary point is a true minimum (positive curvature in all directions = real frequencies)</p> <p>Start a frequency calculation (Reuse data by just hitting <code>Start new job with current data</code> )</p> <p></p> <p>In the \"Job typ\" list select \"Spectra &amp; Excited States --&gt; IR &amp; vibrational frequencies\"</p> <p>Select \"Run (Network)\" to launch the job.</p> <p>From your <code>ProjectList</code>, you can select a job from a project to monitor its progress. You can refresh the view,  but please be patient as the data may take a moment to update. You can also open a separate terminal in the job\u2019s directory (right-click on the job \u2192 Open Shell) and check the job status directly using Slurm commands, for example:</p> <p><pre><code>squeue -u $USER # my current running or queuing jobs\nsacct           # my ended jobs for the last day\nsacct -X -o jobid,start,jobname,state,elapsed,alloc # last jobs with custom fields\n</code></pre> More on these in CSC Computing Environment self learning materials</p> <p>A local terminal on Puhti also gives access to some additional tools and scripts that come with TURBOMOLE that can be nice to follow or post process the data. You can find these e.g.</p> <pre><code>module load turbomole/7.8\nls $TURBODIR/scripts/\ncgnce -h # to get help on usage\nactual -h \n</code></pre> <p>Once the job has finished we note that all calculated frequencies are real, indicating that the structure corresponds to a true minimum.</p> <p></p> <p>The zero Kelvin minimum energy structure in a vacuum is often the starting point in solving chemical problems. It often represents surprisingly well the molecular properties despite all the approximations made. What could you use this information for? How to validate or improve the model?</p> <p>This ends the tutorial.</p>"},{"location":"tutorial2/","title":"Tutorial 2: Find the most stable structure of given isomers","text":"<ul> <li>Spring School on Computational Chemistry 23-25 April 2025</li> <li>Nino Runeberg, CSC - IT center for Science Ltd, based on the earlier work of Atte Sillanp\u00e4\u00e4</li> </ul>"},{"location":"tutorial2/#overview","title":"Overview","text":"<ol> <li>We have downloaded from PubChem a set of molecules having the same molecular formula C<sub>11</sub>H<sub>14</sub>O<sub>2</sub>N<sub>2</sub> . </li> <li>From the original set of about 14700 molecules we have selected 31 structures.    Their corresponding SMILES strings are  given in the table https://siili.rahtiapp.fi/ymroOSSRQTKOewnIDQMrfA# </li> <li>Pick any of the free structures in that table and mark your name on the row (click on side-by-side icon at top left to edit ) </li> <li>Set up a calculation to get the minimum energy conformation according to the same recipe we used for formaldehyde</li> <li>Tabulate the total energy of the corresponding optimized structure</li> <li>Can you explain why some isomers are lower in energy than others?</li> <li>Bonus Would the order change if you'd change the model? Improve basis set? Add an implicit solvent model? Include entropy estimate?</li> </ol>"},{"location":"tutorial2/#open-tmolex-and-create-a-new-project","title":"Open TmoleX and create a new Project","text":"<ol> <li>Launch TmoleX and create a new project in a suitable directory.  </li> <li>If you use the Puhti desktop then use something like  <code>/scratch/project_2013760/&lt;your-username&gt;/qc_tutorial2</code>. Remember to  replace  <code>your-username</code> with your actual username in order to make it a unique and not interfering with other participants projects.</li> <li>If you use a locally installed TmoleX then define the new project under your home directory, e.g. <code>~/qc_tutorial2</code> .</li> <li>A new job is initiated within your new TmoleX project. </li> <li>Rename the first job in this project according to the <code>cid</code> identifier you picked from the list </li> <li>In the first <code>Geometry</code> subsection paste your SMILES string into the slot <code>SMILES to 3D</code>. Pushing the buttons should launch the TmoleX viewer showing the 3D structure of the molecule corresponding to your SMILES string. </li> <li>Since the conversion from <code>SMILES</code> to <code>xyz</code> is quite rough it's often a good idea to do a preoptimization.  </li> <li>Continue in a similar way as we did with formaldehyde and optimize the structure. Do a SMP parallel calculation and request for 8 cores.  </li> <li>Once the structure optimization has (hopefully) converged, fill in the total energy of that structure into the table.  </li> </ol>"},{"location":"tutorial2/#examine-how-long-it-took-to-run-the-job","title":"Examine how long it took to run the job","text":"<p>When a job has finished, all output files are transferred to your project folder and deleted from Puhti's work directory. Amoung the result files yous should have a file called <code>slurm-XXXXXXXXXX.out</code> where <code>XXXXXXXXXX</code>is replaced with a  number that corresponds to the <code>JOBID</code> the job had in Puhti's queuing system. If you would like to have a closer look at the details of that job you should open a <code>Terminal</code> on your desktop. In the terminal you can use the command <code>sacct</code> to collect various data related to the job. Give the command (replace JOBID with the actual number)</p> <p><pre><code>sacct -X -j JOBID -o state,start,alloc,elapsed,cputime\n     State               Start  AllocCPUS    Elapsed    CPUTime \n---------- ------------------- ---------- ---------- ---------- \n COMPLETED 2024-04-15T15:11:06          4   00:10:51   00:43:24 \n</code></pre> Here the <code>Elapsed</code> time is the wall time the job took to finish. </p> <p>Use the optimized structure and define a new job, <code>Start new job with current data</code>, where you change the basis set (<code>Atomic Attributes</code>) to <code>def2-TZVP</code> and define the job as a  <code>Single Point-&gt; Energy (ground state)</code> . Repeat this calculation  using 1,2,4 and 8 cores.  Tabulate the values into a table. You can calculate the \"speedup\" by dividing the 1 core time with N core time. Linear speedup would equal the number of cores used. A speedup above 1.5 when doubling the number of cores is often considered as reasonable.  </p> cores walltime speedup 1 2 4 8"},{"location":"tutorial2/#discussion","title":"Discussion","text":"<ul> <li>Why do the numbers differ?</li> <li>Why do these number matter?</li> <li>Are these numbers accurate?</li> <li>How to get more accurate information?</li> <li>What else affects the performance?</li> </ul>"},{"location":"tutorial2/#tmolex-and-workflows","title":"TmoleX and workflows","text":"<p>Occationally you would like to apply the same model/workflow on a bunch of different structures. An example was the preoptimization followed by an optimization at a higher level that we used for formaldehyde.  Such batch jobs can be easily done with TmoleX.</p> <ol> <li>Create a new project and select <code>Templates -&gt; New/Edit Template</code></li> </ol> <p></p> <ol> <li>Define two job steps corresponding to an AM1 geometry optimization followed by a dft/bp86/sv(p) optimization.</li> </ol> <p></p> <ol> <li> <p>Create a batch <code>New Batch Job</code> and hit <code>Add List of SMILES</code>. In that window add some of the our SMILES strings followed by a name (here the cid number) </p> </li> <li> <p>For the batch of molecules <code>Choose Job Template</code> -&gt; <code>Charge: Use from input</code> -&gt; <code>Apply Job Template</code> </p> </li> <li> <p>Once the template has been selected start the job </p> </li> </ol> <p>This ends the tutorial.</p>"}]}